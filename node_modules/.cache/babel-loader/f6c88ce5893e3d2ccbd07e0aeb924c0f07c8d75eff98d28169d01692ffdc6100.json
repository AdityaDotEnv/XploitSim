{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\PUNARVI\\\\OneDrive\\\\Desktop\\\\Mini-Project\\\\XploitSim\\\\src\\\\components\\\\AuthenticationSandbox.jsx\",\n  _s = $RefreshSig$();\nimport React, { useState, useRef, useEffect } from 'react';\nimport '../index.css';\nimport './VulnerabilityPage.css';\nimport './BrokenAccessControl.css'; // reuse bac-hero styles\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst LOCAL_USERS_KEY = 'xploitsim_users_v1';\nconst LOCAL_LOG_KEY = 'xploitsim_attacklog_v1';\nconst DEFAULT_USERS = [{\n  username: 'alice',\n  password: 'Password@123',\n  attempts: 0,\n  lockedUntil: 0\n}, {\n  username: 'bob',\n  password: 'qwerty',\n  attempts: 0,\n  lockedUntil: 0\n}, {\n  username: 'admin',\n  password: 'admin123',\n  attempts: 0,\n  lockedUntil: 0\n}];\nconst MAX_ATTEMPTS = 5;\nconst LOCK_DURATION_MS = 60 * 1000;\nexport default function AuthenticationSandbox() {\n  _s();\n  const [users, setUsers] = useState(() => {\n    try {\n      const raw = localStorage.getItem(LOCAL_USERS_KEY);\n      if (raw) {\n        const parsed = JSON.parse(raw);\n        return parsed.map(u => ({\n          attempts: 0,\n          lockedUntil: 0,\n          ...u\n        }));\n      }\n    } catch {}\n    return DEFAULT_USERS.slice();\n  });\n  const [attackLog, setAttackLog] = useState(() => {\n    try {\n      const raw = localStorage.getItem(LOCAL_LOG_KEY);\n      if (raw) return JSON.parse(raw);\n    } catch {}\n    return [];\n  });\n  const [username, setUsername] = useState('');\n  const [password, setPassword] = useState('');\n  const [message, setMessage] = useState('Try logging in. Hint: bob / qwerty or admin / admin123');\n  const [isSimulating, setIsSimulating] = useState(false);\n  const simCancelRef = useRef(false);\n  const consoleRef = useRef(null);\n\n  // Replay controls (kept if used later)\n  //const [replayIndex, setReplayIndex] = useState(0);\n  //const [isReplaying, setIsReplaying] = useState(false);\n  //const replayTimerRef = useRef(null);\n  //const REPLAY_INTERVAL_MS = 700;\n\n  // Persist users and logs\n  useEffect(() => {\n    try {\n      localStorage.setItem(LOCAL_USERS_KEY, JSON.stringify(users));\n    } catch {}\n  }, [users]);\n  useEffect(() => {\n    try {\n      localStorage.setItem(LOCAL_LOG_KEY, JSON.stringify(attackLog));\n    } catch {}\n  }, [attackLog]);\n\n  // Prevent page jump on log updates â€” only auto-scroll console if near bottom\n  useEffect(() => {\n    const el = consoleRef.current;\n    if (!el) return;\n    const isNearBottom = el.scrollHeight - el.scrollTop - el.clientHeight < 100;\n    if (isNearBottom) {\n      requestAnimationFrame(() => {\n        el.scrollTop = el.scrollHeight;\n      });\n    }\n  }, [attackLog]);\n  function pushLog(text) {\n    const ts = new Date().toLocaleTimeString();\n    setAttackLog(prev => [...prev, {\n      ts,\n      text\n    }]);\n  }\n  function updateUser(uname, fields) {\n    setUsers(prev => prev.map(u => u.username === uname ? {\n      ...u,\n      ...fields\n    } : u));\n  }\n  function isCurrentlyLocked(user) {\n    if (!user || !user.lockedUntil) return false;\n    const now = Date.now();\n    if (user.lockedUntil > now) return true;\n    updateUser(user.username, {\n      lockedUntil: 0,\n      attempts: 0\n    });\n    return false;\n  }\n  function maskedUsers() {\n    return users.map(u => {\n      const pw = u.password || '';\n      const masked = pw.length <= 2 ? pw : pw[0] + '*'.repeat(Math.max(0, pw.length - 2)) + pw.slice(-1);\n      const attempts = u.attempts || 0;\n      const remaining = Math.max(0, MAX_ATTEMPTS - attempts);\n      const lockedNow = (u.lockedUntil || 0) > Date.now();\n      return {\n        username: u.username,\n        masked,\n        remaining,\n        lockedNow,\n        attempts\n      };\n    });\n  }\n  function handleLogin(e) {\n    var _e$preventDefault;\n    e === null || e === void 0 ? void 0 : (_e$preventDefault = e.preventDefault) === null || _e$preventDefault === void 0 ? void 0 : _e$preventDefault.call(e);\n    const uname = username.trim();\n    if (!uname) {\n      setMessage('Enter a username.');\n      return;\n    }\n    const user = users.find(u => u.username === uname);\n    if (user && isCurrentlyLocked(user)) {\n      setMessage('ðŸ”’ Account locked (simulated).');\n      pushLog(`Attempted login for ${uname} while locked`);\n      return;\n    }\n    if (!user) {\n      setMessage('âŒ Unknown user.');\n      pushLog(`Failed login attempt: ${uname} (unknown user)`);\n      return;\n    }\n    if (user.password === password) {\n      setMessage(`âœ… Welcome, ${uname}!`);\n      pushLog(`Successful login: ${uname}`);\n      updateUser(uname, {\n        attempts: 0,\n        lockedUntil: 0\n      });\n    } else {\n      const newAttempts = (user.attempts || 0) + 1;\n      if (newAttempts >= MAX_ATTEMPTS) {\n        const until = Date.now() + LOCK_DURATION_MS;\n        updateUser(uname, {\n          attempts: newAttempts,\n          lockedUntil: until\n        });\n        setMessage('ðŸ”’ Too many failed attempts â€” account locked.');\n        pushLog(`Failed login attempt: ${uname} (attempt ${newAttempts})`);\n        pushLog(`Account ${uname} locked until ${new Date(until).toLocaleTimeString()}`);\n      } else {\n        updateUser(uname, {\n          attempts: newAttempts\n        });\n        setMessage('âŒ Invalid username or password.');\n        pushLog(`Failed login attempt: ${uname} (attempt ${newAttempts})`);\n      }\n    }\n  }\n  function handleRegister() {\n    const uname = username.trim();\n    if (!uname || !password) {\n      setMessage('Enter username and password to register.');\n      return;\n    }\n    if (users.some(u => u.username === uname)) {\n      setMessage('User already exists.');\n      return;\n    }\n    setUsers(prev => [...prev, {\n      username: uname,\n      password,\n      attempts: 0,\n      lockedUntil: 0\n    }]);\n    setMessage(`âœ… Registered ${uname} (in-memory).`);\n    pushLog(`Registered new user: ${uname}`);\n  }\n  function resetDemo() {\n    setUsers(prev => prev.map(u => ({\n      ...u,\n      attempts: 0,\n      lockedUntil: 0\n    })));\n    setAttackLog([]);\n    setMessage('Demo reset.');\n    pushLog('Demo reset.');\n  }\n  async function runCredentialStuffingAsync() {\n    const common = ['123456', 'password', 'qwerty', 'admin', 'admin123'];\n    const targets = Array.from(new Set([...users.map(u => u.username), 'carol', 'dave']));\n    setIsSimulating(true);\n    simCancelRef.current = false;\n    pushLog('--- Credential Stuffing Simulation started ---');\n    for (const t of targets) {\n      if (simCancelRef.current) break;\n      const user = users.find(u => u.username === t);\n      if (user && isCurrentlyLocked(user)) {\n        pushLog(`${t}: <LOCKED>`);\n        continue;\n      }\n      for (const pw of common) {\n        if (simCancelRef.current) break;\n        await new Promise(r => setTimeout(r, 250));\n        const fresh = users.find(u => u.username === t);\n        if (!fresh) {\n          pushLog(`${t}:${pw} -> FAIL (no user)`);\n          continue;\n        }\n        if (isCurrentlyLocked(fresh)) {\n          pushLog(`${t}:${pw} -> FAIL (LOCKED)`);\n          continue;\n        }\n        if (fresh.password === pw) {\n          updateUser(fresh.username, {\n            attempts: 0,\n            lockedUntil: 0\n          });\n          pushLog(`${t}:${pw} -> SUCCESS`);\n        } else {\n          const newAttempts = (fresh.attempts || 0) + 1;\n          if (newAttempts >= MAX_ATTEMPTS) {\n            const until = Date.now() + LOCK_DURATION_MS;\n            updateUser(fresh.username, {\n              attempts: newAttempts,\n              lockedUntil: until\n            });\n            pushLog(`${t}:${pw} -> FAIL (attempt ${newAttempts})`);\n            pushLog(`${t} locked until ${new Date(until).toLocaleTimeString()}`);\n          } else {\n            updateUser(fresh.username, {\n              attempts: newAttempts\n            });\n            pushLog(`${t}:${pw} -> FAIL (attempt ${newAttempts})`);\n          }\n        }\n      }\n    }\n    pushLog('--- Credential Stuffing Simulation completed ---');\n    setIsSimulating(false);\n  }\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"broken-access-page\",\n    children: [/*#__PURE__*/_jsxDEV(\"section\", {\n      className: \"bac-hero\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"bac-hero-content\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"bac-hero-text\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"bac-badge\",\n            children: \"A02:2021\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 225,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"h1\", {\n            className: \"bac-title\",\n            children: \"Authentication Failures Sandbox\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 226,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"bac-subtitle\",\n            children: \"Explore login attempt tracking, credential stuffing, and simulated account lockouts \\u2014 all in-browser and persistent.\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 227,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 224,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 223,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 222,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"main\", {\n      className: \"vp-container\",\n      style: {\n        display: 'flex',\n        justifyContent: 'center'\n      },\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"vp-grid\",\n        style: {\n          maxWidth: 1100,\n          gap: 16\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"vp-card\",\n          style: {\n            textAlign: 'center'\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n            children: \"Login / Register\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 238,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n            onSubmit: handleLogin,\n            className: \"vp-form\",\n            style: {\n              marginTop: 8\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              children: \"Username\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 241,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n              value: username,\n              onChange: e => setUsername(e.target.value),\n              className: \"vp-input\",\n              style: {\n                marginBottom: 10\n              }\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 242,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n              children: \"Password\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 249,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"password\",\n              value: password,\n              onChange: e => setPassword(e.target.value),\n              className: \"vp-input\",\n              style: {\n                marginBottom: 15\n              }\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 250,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                marginTop: 12\n              },\n              children: [/*#__PURE__*/_jsxDEV(\"button\", {\n                className: \"vp-btn\",\n                type: \"submit\",\n                children: \"Login\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 259,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                type: \"button\",\n                className: \"vp-btn vp-btn-secondary\",\n                onClick: handleRegister,\n                style: {\n                  marginLeft: 8\n                },\n                children: \"Register\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 260,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                type: \"button\",\n                className: \"vp-btn vp-btn-secondary\",\n                onClick: resetDemo,\n                style: {\n                  marginLeft: 8\n                },\n                children: \"Reset Demo\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 268,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 258,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 240,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"vp-note\",\n            style: {\n              marginTop: 10\n            },\n            children: message\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 279,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              marginTop: 12\n            },\n            children: !isSimulating ? /*#__PURE__*/_jsxDEV(\"button\", {\n              className: \"vp-btn vp-btn-danger\",\n              onClick: runCredentialStuffingAsync,\n              children: \"Start Credential Stuffing\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 283,\n              columnNumber: 17\n            }, this) : /*#__PURE__*/_jsxDEV(\"button\", {\n              className: \"vp-btn vp-btn-secondary\",\n              onClick: () => {\n                simCancelRef.current = true;\n                setIsSimulating(false);\n              },\n              children: \"Stop Simulation\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 285,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 281,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              marginTop: 16\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n              children: \"Registered Users\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 292,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                display: 'flex',\n                flexWrap: 'wrap',\n                gap: 10,\n                justifyContent: 'center',\n                marginTop: 8\n              },\n              children: maskedUsers().map(u => /*#__PURE__*/_jsxDEV(\"div\", {\n                style: {\n                  background: 'rgba(255,255,255,0.04)',\n                  padding: '8px 12px',\n                  borderRadius: 10\n                },\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  style: {\n                    fontWeight: 700\n                  },\n                  children: [u.username, u.lockedNow ? ' ðŸ”’' : '']\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 296,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  style: {\n                    fontSize: 12\n                  },\n                  children: u.masked\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 297,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  style: {\n                    marginTop: 6,\n                    fontSize: 13\n                  },\n                  children: [\"Attempts: \", /*#__PURE__*/_jsxDEV(\"strong\", {\n                    children: u.attempts\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 299,\n                    columnNumber: 33\n                  }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 299,\n                    columnNumber: 62\n                  }, this), \"Remaining: \", /*#__PURE__*/_jsxDEV(\"strong\", {\n                    children: u.remaining\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 300,\n                    columnNumber: 34\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 298,\n                  columnNumber: 21\n                }, this)]\n              }, u.username, true, {\n                fileName: _jsxFileName,\n                lineNumber: 295,\n                columnNumber: 19\n              }, this))\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 293,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 291,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 237,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"vp-card\",\n          style: {\n            flex: 1\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n            children: \"Attack Log\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 310,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            ref: consoleRef,\n            className: \"vp-log\",\n            style: {\n              background: '#0b1020',\n              color: '#d1d5db',\n              fontFamily: 'ui-monospace, Menlo, Monaco, monospace',\n              padding: 12,\n              borderRadius: 8,\n              minHeight: 260,\n              maxHeight: 360,\n              overflowY: 'auto',\n              border: '1px solid rgba(255,255,255,0.05)'\n            },\n            children: attackLog.length === 0 ? /*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                opacity: 0.7\n              },\n              children: \"Console empty \\u2014 perform logins or start simulation.\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 327,\n              columnNumber: 17\n            }, this) : attackLog.map((entry, i) => /*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                marginBottom: 6\n              },\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                style: {\n                  color: '#9ca3af'\n                },\n                children: [\"[\", entry.ts, \"] \"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 331,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                children: entry.text\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 332,\n                columnNumber: 21\n              }, this)]\n            }, i, true, {\n              fileName: _jsxFileName,\n              lineNumber: 330,\n              columnNumber: 19\n            }, this))\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 311,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 309,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 235,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 234,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 220,\n    columnNumber: 5\n  }, this);\n}\n_s(AuthenticationSandbox, \"EwMMUhPitg8/tXQGcTCTLr1u8Ew=\");\n_c = AuthenticationSandbox;\nvar _c;\n$RefreshReg$(_c, \"AuthenticationSandbox\");","map":{"version":3,"names":["React","useState","useRef","useEffect","jsxDEV","_jsxDEV","LOCAL_USERS_KEY","LOCAL_LOG_KEY","DEFAULT_USERS","username","password","attempts","lockedUntil","MAX_ATTEMPTS","LOCK_DURATION_MS","AuthenticationSandbox","_s","users","setUsers","raw","localStorage","getItem","parsed","JSON","parse","map","u","slice","attackLog","setAttackLog","setUsername","setPassword","message","setMessage","isSimulating","setIsSimulating","simCancelRef","consoleRef","setItem","stringify","el","current","isNearBottom","scrollHeight","scrollTop","clientHeight","requestAnimationFrame","pushLog","text","ts","Date","toLocaleTimeString","prev","updateUser","uname","fields","isCurrentlyLocked","user","now","maskedUsers","pw","masked","length","repeat","Math","max","remaining","lockedNow","handleLogin","e","_e$preventDefault","preventDefault","call","trim","find","newAttempts","until","handleRegister","some","resetDemo","runCredentialStuffingAsync","common","targets","Array","from","Set","t","Promise","r","setTimeout","fresh","className","children","fileName","_jsxFileName","lineNumber","columnNumber","style","display","justifyContent","maxWidth","gap","textAlign","onSubmit","marginTop","value","onChange","target","marginBottom","type","onClick","marginLeft","flexWrap","background","padding","borderRadius","fontWeight","fontSize","flex","ref","color","fontFamily","minHeight","maxHeight","overflowY","border","opacity","entry","i","_c","$RefreshReg$"],"sources":["C:/Users/PUNARVI/OneDrive/Desktop/Mini-Project/XploitSim/src/components/AuthenticationSandbox.jsx"],"sourcesContent":["import React, { useState, useRef, useEffect } from 'react';\r\nimport '../index.css';\r\nimport './VulnerabilityPage.css';\r\nimport './BrokenAccessControl.css'; // reuse bac-hero styles\r\n\r\nconst LOCAL_USERS_KEY = 'xploitsim_users_v1';\r\nconst LOCAL_LOG_KEY = 'xploitsim_attacklog_v1';\r\n\r\nconst DEFAULT_USERS = [\r\n  { username: 'alice', password: 'Password@123', attempts: 0, lockedUntil: 0 },\r\n  { username: 'bob', password: 'qwerty', attempts: 0, lockedUntil: 0 },\r\n  { username: 'admin', password: 'admin123', attempts: 0, lockedUntil: 0 }\r\n];\r\n\r\nconst MAX_ATTEMPTS = 5;\r\nconst LOCK_DURATION_MS = 60 * 1000;\r\n\r\nexport default function AuthenticationSandbox() {\r\n  const [users, setUsers] = useState(() => {\r\n    try {\r\n      const raw = localStorage.getItem(LOCAL_USERS_KEY);\r\n      if (raw) {\r\n        const parsed = JSON.parse(raw);\r\n        return parsed.map(u => ({ attempts: 0, lockedUntil: 0, ...u }));\r\n      }\r\n    } catch {}\r\n    return DEFAULT_USERS.slice();\r\n  });\r\n\r\n  const [attackLog, setAttackLog] = useState(() => {\r\n    try {\r\n      const raw = localStorage.getItem(LOCAL_LOG_KEY);\r\n      if (raw) return JSON.parse(raw);\r\n    } catch {}\r\n    return [];\r\n  });\r\n\r\n  const [username, setUsername] = useState('');\r\n  const [password, setPassword] = useState('');\r\n  const [message, setMessage] = useState('Try logging in. Hint: bob / qwerty or admin / admin123');\r\n  const [isSimulating, setIsSimulating] = useState(false);\r\n  const simCancelRef = useRef(false);\r\n  const consoleRef = useRef(null);\r\n\r\n  // Replay controls (kept if used later)\r\n  //const [replayIndex, setReplayIndex] = useState(0);\r\n  //const [isReplaying, setIsReplaying] = useState(false);\r\n  //const replayTimerRef = useRef(null);\r\n  //const REPLAY_INTERVAL_MS = 700;\r\n\r\n  // Persist users and logs\r\n  useEffect(() => {\r\n    try {\r\n      localStorage.setItem(LOCAL_USERS_KEY, JSON.stringify(users));\r\n    } catch {}\r\n  }, [users]);\r\n\r\n  useEffect(() => {\r\n    try {\r\n      localStorage.setItem(LOCAL_LOG_KEY, JSON.stringify(attackLog));\r\n    } catch {}\r\n  }, [attackLog]);\r\n\r\n  // Prevent page jump on log updates â€” only auto-scroll console if near bottom\r\n  useEffect(() => {\r\n    const el = consoleRef.current;\r\n    if (!el) return;\r\n    const isNearBottom = el.scrollHeight - el.scrollTop - el.clientHeight < 100;\r\n    if (isNearBottom) {\r\n      requestAnimationFrame(() => {\r\n        el.scrollTop = el.scrollHeight;\r\n      });\r\n    }\r\n  }, [attackLog]);\r\n\r\n  function pushLog(text) {\r\n    const ts = new Date().toLocaleTimeString();\r\n    setAttackLog(prev => [...prev, { ts, text }]);\r\n  }\r\n\r\n  function updateUser(uname, fields) {\r\n    setUsers(prev => prev.map(u => (u.username === uname ? { ...u, ...fields } : u)));\r\n  }\r\n\r\n  function isCurrentlyLocked(user) {\r\n    if (!user || !user.lockedUntil) return false;\r\n    const now = Date.now();\r\n    if (user.lockedUntil > now) return true;\r\n    updateUser(user.username, { lockedUntil: 0, attempts: 0 });\r\n    return false;\r\n  }\r\n\r\n  function maskedUsers() {\r\n    return users.map(u => {\r\n      const pw = u.password || '';\r\n      const masked = pw.length <= 2 ? pw : pw[0] + '*'.repeat(Math.max(0, pw.length - 2)) + pw.slice(-1);\r\n      const attempts = u.attempts || 0;\r\n      const remaining = Math.max(0, MAX_ATTEMPTS - attempts);\r\n      const lockedNow = (u.lockedUntil || 0) > Date.now();\r\n      return { username: u.username, masked, remaining, lockedNow, attempts };\r\n    });\r\n  }\r\n\r\n  function handleLogin(e) {\r\n    e?.preventDefault?.();\r\n    const uname = username.trim();\r\n    if (!uname) {\r\n      setMessage('Enter a username.');\r\n      return;\r\n    }\r\n    const user = users.find(u => u.username === uname);\r\n\r\n    if (user && isCurrentlyLocked(user)) {\r\n      setMessage('ðŸ”’ Account locked (simulated).');\r\n      pushLog(`Attempted login for ${uname} while locked`);\r\n      return;\r\n    }\r\n\r\n    if (!user) {\r\n      setMessage('âŒ Unknown user.');\r\n      pushLog(`Failed login attempt: ${uname} (unknown user)`);\r\n      return;\r\n    }\r\n\r\n    if (user.password === password) {\r\n      setMessage(`âœ… Welcome, ${uname}!`);\r\n      pushLog(`Successful login: ${uname}`);\r\n      updateUser(uname, { attempts: 0, lockedUntil: 0 });\r\n    } else {\r\n      const newAttempts = (user.attempts || 0) + 1;\r\n      if (newAttempts >= MAX_ATTEMPTS) {\r\n        const until = Date.now() + LOCK_DURATION_MS;\r\n        updateUser(uname, { attempts: newAttempts, lockedUntil: until });\r\n        setMessage('ðŸ”’ Too many failed attempts â€” account locked.');\r\n        pushLog(`Failed login attempt: ${uname} (attempt ${newAttempts})`);\r\n        pushLog(`Account ${uname} locked until ${new Date(until).toLocaleTimeString()}`);\r\n      } else {\r\n        updateUser(uname, { attempts: newAttempts });\r\n        setMessage('âŒ Invalid username or password.');\r\n        pushLog(`Failed login attempt: ${uname} (attempt ${newAttempts})`);\r\n      }\r\n    }\r\n  }\r\n\r\n  function handleRegister() {\r\n    const uname = username.trim();\r\n    if (!uname || !password) {\r\n      setMessage('Enter username and password to register.');\r\n      return;\r\n    }\r\n    if (users.some(u => u.username === uname)) {\r\n      setMessage('User already exists.');\r\n      return;\r\n    }\r\n    setUsers(prev => [...prev, { username: uname, password, attempts: 0, lockedUntil: 0 }]);\r\n    setMessage(`âœ… Registered ${uname} (in-memory).`);\r\n    pushLog(`Registered new user: ${uname}`);\r\n  }\r\n\r\n  function resetDemo() {\r\n    setUsers(prev => prev.map(u => ({ ...u, attempts: 0, lockedUntil: 0 })));\r\n    setAttackLog([]);\r\n    setMessage('Demo reset.');\r\n    pushLog('Demo reset.');\r\n  }\r\n\r\n  async function runCredentialStuffingAsync() {\r\n    const common = ['123456', 'password', 'qwerty', 'admin', 'admin123'];\r\n    const targets = Array.from(new Set([...users.map(u => u.username), 'carol', 'dave']));\r\n\r\n    setIsSimulating(true);\r\n    simCancelRef.current = false;\r\n    pushLog('--- Credential Stuffing Simulation started ---');\r\n\r\n    for (const t of targets) {\r\n      if (simCancelRef.current) break;\r\n\r\n      const user = users.find(u => u.username === t);\r\n      if (user && isCurrentlyLocked(user)) {\r\n        pushLog(`${t}: <LOCKED>`);\r\n        continue;\r\n      }\r\n\r\n      for (const pw of common) {\r\n        if (simCancelRef.current) break;\r\n        await new Promise(r => setTimeout(r, 250));\r\n\r\n        const fresh = users.find(u => u.username === t);\r\n        if (!fresh) {\r\n          pushLog(`${t}:${pw} -> FAIL (no user)`);\r\n          continue;\r\n        }\r\n        if (isCurrentlyLocked(fresh)) {\r\n          pushLog(`${t}:${pw} -> FAIL (LOCKED)`);\r\n          continue;\r\n        }\r\n        if (fresh.password === pw) {\r\n          updateUser(fresh.username, { attempts: 0, lockedUntil: 0 });\r\n          pushLog(`${t}:${pw} -> SUCCESS`);\r\n        } else {\r\n          const newAttempts = (fresh.attempts || 0) + 1;\r\n          if (newAttempts >= MAX_ATTEMPTS) {\r\n            const until = Date.now() + LOCK_DURATION_MS;\r\n            updateUser(fresh.username, { attempts: newAttempts, lockedUntil: until });\r\n            pushLog(`${t}:${pw} -> FAIL (attempt ${newAttempts})`);\r\n            pushLog(`${t} locked until ${new Date(until).toLocaleTimeString()}`);\r\n          } else {\r\n            updateUser(fresh.username, { attempts: newAttempts });\r\n            pushLog(`${t}:${pw} -> FAIL (attempt ${newAttempts})`);\r\n          }\r\n        }\r\n      }\r\n    }\r\n\r\n    pushLog('--- Credential Stuffing Simulation completed ---');\r\n    setIsSimulating(false);\r\n  }\r\n\r\n  return (\r\n    <div className=\"broken-access-page\">\r\n      {/* Hero Section */}\r\n      <section className=\"bac-hero\">\r\n        <div className=\"bac-hero-content\">\r\n          <div className=\"bac-hero-text\">\r\n            <div className=\"bac-badge\">A02:2021</div>\r\n            <h1 className=\"bac-title\">Authentication Failures Sandbox</h1>\r\n            <p className=\"bac-subtitle\">\r\n              Explore login attempt tracking, credential stuffing, and simulated account lockouts â€” all in-browser and persistent.\r\n            </p>\r\n          </div>\r\n        </div>\r\n      </section>\r\n\r\n      <main className=\"vp-container\" style={{ display: 'flex', justifyContent: 'center' }}>\r\n        <div className=\"vp-grid\" style={{ maxWidth: 1100, gap: 16 }}>\r\n          {/* LEFT PANEL */}\r\n          <div className=\"vp-card\" style={{ textAlign: 'center' }}>\r\n            <h3>Login / Register</h3>\r\n\r\n            <form onSubmit={handleLogin} className=\"vp-form\" style={{ marginTop: 8 }}>\r\n              <label>Username</label>\r\n              <input\r\n                value={username}\r\n                onChange={e => setUsername(e.target.value)}\r\n                className=\"vp-input\"\r\n                style={{ marginBottom: 10 }}\r\n              />\r\n\r\n              <label>Password</label>\r\n              <input\r\n                type=\"password\"\r\n                value={password}\r\n                onChange={e => setPassword(e.target.value)}\r\n                className=\"vp-input\"\r\n                style={{ marginBottom: 15 }}\r\n              />\r\n\r\n              <div style={{ marginTop: 12 }}>\r\n                <button className=\"vp-btn\" type=\"submit\">Login</button>\r\n                <button\r\n                  type=\"button\"\r\n                  className=\"vp-btn vp-btn-secondary\"\r\n                  onClick={handleRegister}\r\n                  style={{ marginLeft: 8 }}\r\n                >\r\n                  Register\r\n                </button>\r\n                <button\r\n                  type=\"button\"\r\n                  className=\"vp-btn vp-btn-secondary\"\r\n                  onClick={resetDemo}\r\n                  style={{ marginLeft: 8 }}\r\n                >\r\n                  Reset Demo\r\n                </button>\r\n              </div>\r\n            </form>\r\n\r\n            <p className=\"vp-note\" style={{ marginTop: 10 }}>{message}</p>\r\n\r\n            <div style={{ marginTop: 12 }}>\r\n              {!isSimulating ? (\r\n                <button className=\"vp-btn vp-btn-danger\" onClick={runCredentialStuffingAsync}>Start Credential Stuffing</button>\r\n              ) : (\r\n                <button className=\"vp-btn vp-btn-secondary\" onClick={() => { simCancelRef.current = true; setIsSimulating(false); }}>\r\n                  Stop Simulation\r\n                </button>\r\n              )}\r\n            </div>\r\n\r\n            <div style={{ marginTop: 16 }}>\r\n              <h4>Registered Users</h4>\r\n              <div style={{ display: 'flex', flexWrap: 'wrap', gap: 10, justifyContent: 'center', marginTop: 8 }}>\r\n                {maskedUsers().map(u => (\r\n                  <div key={u.username} style={{ background: 'rgba(255,255,255,0.04)', padding: '8px 12px', borderRadius: 10 }}>\r\n                    <div style={{ fontWeight: 700 }}>{u.username}{u.lockedNow ? ' ðŸ”’' : ''}</div>\r\n                    <div style={{ fontSize: 12 }}>{u.masked}</div>\r\n                    <div style={{ marginTop: 6, fontSize: 13 }}>\r\n                      Attempts: <strong>{u.attempts}</strong><br />\r\n                      Remaining: <strong>{u.remaining}</strong>\r\n                    </div>\r\n                  </div>\r\n                ))}\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          {/* RIGHT PANEL */}\r\n          <div className=\"vp-card\" style={{ flex: 1 }}>\r\n            <h3>Attack Log</h3>\r\n            <div\r\n              ref={consoleRef}\r\n              className=\"vp-log\"\r\n              style={{\r\n                background: '#0b1020',\r\n                color: '#d1d5db',\r\n                fontFamily: 'ui-monospace, Menlo, Monaco, monospace',\r\n                padding: 12,\r\n                borderRadius: 8,\r\n                minHeight: 260,\r\n                maxHeight: 360,\r\n                overflowY: 'auto',\r\n                border: '1px solid rgba(255,255,255,0.05)'\r\n              }}\r\n            >\r\n              {attackLog.length === 0 ? (\r\n                <div style={{ opacity: 0.7 }}>Console empty â€” perform logins or start simulation.</div>\r\n              ) : (\r\n                attackLog.map((entry, i) => (\r\n                  <div key={i} style={{ marginBottom: 6 }}>\r\n                    <span style={{ color: '#9ca3af' }}>[{entry.ts}] </span>\r\n                    <span>{entry.text}</span>\r\n                  </div>\r\n                ))\r\n              )}\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </main>\r\n    </div>\r\n  );\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}